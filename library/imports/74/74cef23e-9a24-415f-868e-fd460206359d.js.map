{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["Player","require","module","exports","curScript","scene","cc","Class","extends","Component","properties","ground","default","type","Node","player","monster1Prefab","Prefab","bossPrefab","blastPrefab","chatBoxPrefab","guideCatPrefab","instructionDisplay","Label","startBGMAudio","AudioClip","bgmAudio","getaBlastLocation","blastLocation","getPosition","playerInfo","getComponent","faceDirection","x","leftOnSkill","rightOnSkill","y","frontOnSkill","backOnSkill","getMonsterPosition","randX","Math","random","node","getChildByName","width","randY","height","v2","showMonster1","monster","instantiate","addChild","setPosition","showBoss","boss","posX","posY","produceBlast","console","log","children","fireBlast","showChatBox","chatBox","showGuideCat","guideCat","playStartBGMSound","bgm","audioEngine","play","playBGMSound","stopSound","stop","onLoad","score","timer","timeInterval","difficultyTimer","difficultyInterval","end","monsterRespawnSpeed","lose","gameStart","bossFight","onDestroy","systemEvent","off","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","event","keyCode","macro","KEY","j","u","clearScene","letGameStart","r","restartGame","guideInfo","string","playerAction","action","moveAround","update","dt","temp","removeChild","endScene","i","startScene","setTimeout","on","bind","start"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nvar Player = require(\"Player\");\r\n\r\nmodule.exports = {\r\n    curScript: 0,\r\n    scene: 0,\r\n};\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        ground: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        player: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        monster1Prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        bossPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        blastPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        chatBoxPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        guideCatPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        instructionDisplay: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n\r\n        startBGMAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n\r\n        bgmAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n\r\n    },\r\n\r\n    \r\n\r\n    getaBlastLocation: function () {\r\n        var blastLocation = this.player.getPosition();\r\n        var playerInfo = this.player.getComponent(Player);\r\n        \r\n        var faceDirection = playerInfo.faceDirection;\r\n        switch (faceDirection) {\r\n            case 'left':\r\n                blastLocation.x -= 100;\r\n                playerInfo.leftOnSkill = true;\r\n                break;\r\n            case 'right':\r\n                blastLocation.x += 100;\r\n                playerInfo.rightOnSkill = true;\r\n                break;\r\n            case 'front':\r\n                blastLocation.y -= 100;\r\n                playerInfo.frontOnSkill = true;\r\n                break;\r\n            case 'back':\r\n                blastLocation.y += 100;\r\n                playerInfo.backOnSkill = true;\r\n                break;\r\n        }\r\n        return blastLocation;\r\n    },\r\n\r\n    getMonsterPosition: function () {\r\n        var randX = (Math.random() - 0.5) * 2 * (this.node.getChildByName(\"newbg\").width / 2 - 50);\r\n        var randY = (Math.random() - 0.5) * 2 * (this.node.getChildByName(\"newbg\").height / 2 - 50);\r\n\r\n        return cc.v2(randX, randY);\r\n    },\r\n\r\n    showMonster1() {\r\n        var monster = cc.instantiate(this.monster1Prefab);\r\n        this.node.addChild(monster);\r\n        monster.setPosition(this.getMonsterPosition());\r\n    },\r\n\r\n    showBoss() {\r\n        var boss = cc.instantiate(this.bossPrefab);\r\n        this.node.addChild(boss);\r\n        var posX = this.node.x - this.node.width/2;\r\n        var posY = this.node.y - 100;\r\n        boss.setPosition(cc.v2(posX, posY));\r\n    },\r\n\r\n    produceBlast() {\r\n        console.log(this.node.children);\r\n        var fireBlast = cc.instantiate(this.blastPrefab);\r\n        this.node.addChild(fireBlast);\r\n        fireBlast.setPosition(this.getaBlastLocation());\r\n    },\r\n\r\n    showChatBox(){\r\n        var chatBox = cc.instantiate(this.chatBoxPrefab);\r\n        this.node.addChild(chatBox);\r\n        chatBox.setPosition(cc.v2(this.node.x - this.node.width/2, this.node.y - this.node.height*3/4));\r\n    },\r\n\r\n    showGuideCat(){\r\n        var guideCat = cc.instantiate(this.guideCatPrefab);\r\n        this.node.addChild(guideCat);\r\n        guideCat.setPosition(cc.v2(this.player.x + 450, this.player.y)); \r\n    },\r\n\r\n    playStartBGMSound(){\r\n        this.bgm = cc.audioEngine.play(this.startBGMAudio, false, 0.7);\r\n    },\r\n\r\n\r\n    playBGMSound(){\r\n        this.bgm = cc.audioEngine.play(this.bgmAudio, false, 0.7);\r\n    },\r\n\r\n    stopSound(){\r\n        cc.audioEngine.stop(this.bgm);\r\n    },\r\n\r\n\r\n    onLoad: function () {\r\n        this.score = 0;\r\n        this.timer = 0;\r\n        this.timeInterval = 3;\r\n        this.difficultyTimer = 0;\r\n        this.difficultyInterval = 20;\r\n        this.end = 60;\r\n        this.monsterRespawnSpeed = 1;\r\n        this.lose = false;\r\n        this.gameStart = false;\r\n        this.bossFight = false;\r\n        // this.curScript = 0;\r\n    },\r\n\r\n\r\n    onDestroy() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n\r\n    onKeyDown(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.j:\r\n                this.produceBlast();\r\n                break;\r\n            case cc.macro.KEY.u:\r\n                this.clearScene();\r\n                this.letGameStart();\r\n                break;\r\n            case cc.macro.KEY.r:\r\n                if(!this.gameStart) this.restartGame();\r\n                break;\r\n        }\r\n\r\n    },\r\n\r\n    letGameStart(){\r\n        if(!this.gameStart){\r\n            console.log(\"游戏开始\");\r\n            this.gameStart = true;\r\n            if(this.node.getChildByName(\"guide\") == null){\r\n                this.showGuideCat();\r\n            }\r\n            var guideInfo = this.node.getChildByName(\"guide\").getComponent(\"GuideCat\");\r\n            guideInfo.timer = 0;\r\n            guideInfo.timeInterval = 5;\r\n            this.instructionDisplay.string = \"WASD to control move\\n\\r J to use skill\";\r\n            this.stopSound();\r\n            this.playBGMSound();\r\n        }\r\n    },\r\n\r\n    playerAction(action){\r\n        var playerInfo = this.player.getComponent(Player);\r\n        if(action == 1) playerInfo.moveAround = true;\r\n    },\r\n\r\n    update: function (dt) {\r\n        if(this.gameStart){\r\n            if(this.lose){\r\n                while(true){\r\n                    var temp = this.node.getChildByName(\"hulk-1\");\r\n                    if(temp == null) break;\r\n                    this.node.removeChild(temp);\r\n                }\r\n                while(true){\r\n                    var temp = this.node.getChildByName(\"bullet\");\r\n                    if(temp == null) break;\r\n                    this.node.removeChild(temp);\r\n                }\r\n                while(true){\r\n                    var temp = this.node.getChildByName(\"red-bullet\");\r\n                    if(temp == null) break;\r\n                    this.node.removeChild(temp);\r\n                }\r\n                this.node.removeChild(this.node.getChildByName(\"boss\"));\r\n                this.gameStart = false;\r\n                this.instructionDisplay.string = \"You lost. \\n\\rPress R to restart\";\r\n                return;\r\n            }\r\n            if(this.end <= 0){\r\n                if(!this.bossFight){\r\n                    this.showBoss();\r\n                    this.bossFight = true;\r\n                }\r\n                if(this.node.getChildByName(\"hulk-1\") == null && this.node.getChildByName(\"boss\") == null){\r\n                    var guideInfo = this.node.getChildByName(\"guide\").getComponent(\"GuideCat\");\r\n                    guideInfo.timeInterval = 9999;\r\n                    this.gameStart = false;\r\n                    this.endScene();\r\n                    this.instructionDisplay.string = \"The end of Demo...\";\r\n                }\r\n            }\r\n            else{\r\n                if(this.timer >= this.timeInterval){\r\n                    this.timer = 0;\r\n                    for(var i = 0; i < this.monsterRespawnSpeed; i++){\r\n                        console.log(\"怪物出现\");\r\n                        this.showMonster1();\r\n                    }\r\n                }\r\n                if(this.difficultyTimer >= this.difficultyInterval){\r\n                    this.instructionDisplay.string = \"\";\r\n                    this.difficultyTimer = 0;\r\n                    this.monsterRespawnSpeed++;\r\n                }\r\n                this.difficultyTimer += dt;\r\n                this.timer += dt;\r\n                this.end -= dt;\r\n            }\r\n        }\r\n    },\r\n\r\n    endScene(){\r\n        this.showChatBox();\r\n    },\r\n\r\n    restartGame(){\r\n        this.stopSound();\r\n        this.score = 0;\r\n        this.timer = 0;\r\n        this.timeInterval = 3;\r\n        this.difficultyTimer = 0;\r\n        this.difficultyInterval = 30;\r\n        this.end = 90;\r\n        this.monsterRespawnSpeed = 1;\r\n        this.lose = false;\r\n        this.gameStart = false;\r\n        this.bossFight = false;\r\n        this.letGameStart();\r\n    },\r\n\r\n    startScene(){\r\n        this.playerAction(1);\r\n        setTimeout(function () {\r\n            if(!this.gameStart){\r\n                this.showChatBox();\r\n                cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n                cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n                this.instructionDisplay.string = \"Press U to skip...\";\r\n            }\r\n        }.bind(this), 7000);\r\n\r\n        setTimeout(function () {\r\n            if(!this.gameStart) this.showGuideCat();\r\n        }.bind(this), 15000);\r\n\r\n        setTimeout(function () {\r\n            if(!this.gameStart){\r\n                this.letGameStart();\r\n            }\r\n        }.bind(this), 30500);\r\n    },\r\n\r\n    clearScene(){\r\n        this.node.removeChild(this.node.getChildByName(\"chatbox\"));\r\n    },\r\n\r\n    start() {\r\n        this.playStartBGMSound();\r\n        setTimeout(function () {\r\n            this.startScene();\r\n        }.bind(this), 1000);\r\n    }\r\n\r\n});\r\n"]}