{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Blast.js"],"names":["cc","Class","extends","Component","properties","blastRadius","blastAudio","default","type","AudioClip","onLoad","startTime","time","blastAnimation","hitBoss","playBlastSound","animationComponent","getComponent","Animation","animState","play","speed","detectMonster","scene","node","parent","children","playerPos","getChildByName","getPosition","boss","Math","abs","y","width","height","x","console","log","life","i","length","tempMonster","name","monsterPos","v2","dist","position","sub","mag","removeChild","audioEngine","start","update","dt","destroy"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAa,CADL;AAERC,oBAAY;AACRC,qBAAS,IADD;AAERC,kBAAMR,GAAGS;AAFD;AAFJ,KAHP;;AAWL;;AAEAC,UAbK,oBAaK;AACN,aAAKC,SAAL,GAAiB,GAAjB;AACA,aAAKC,IAAL,GAAY,CAAZ;AACA,aAAKC,cAAL;AACA,aAAKC,OAAL,GAAe,KAAf;AACH,KAlBI;AAoBLD,kBApBK,4BAoBW;AACZ,aAAKE,cAAL;AACA,YAAIC,qBAAqB,KAAKC,YAAL,CAAkBjB,GAAGkB,SAArB,CAAzB;AACA,YAAIC,YAAYH,mBAAmBI,IAAnB,CAAwB,OAAxB,CAAhB;AACAD,kBAAUE,KAAV,GAAkB,CAAlB;AACH,KAzBI;AA2BLC,iBA3BK,2BA2BU;AACX,YAAIC,QAAQ,KAAKC,IAAL,CAAUC,MAAtB;AACA,YAAIC,WAAWH,MAAMG,QAArB;AACA,YAAIC,YAAYJ,MAAMK,cAAN,CAAqB,KAArB,EAA4BC,WAA5B,EAAhB;;AAEA,YAAIC,OAAOP,MAAMK,cAAN,CAAqB,MAArB,CAAX;AACA;AACA,YAAGE,QAAQ,IAAX,EAAgB;AACZ,gBAAG,CAAC,KAAKhB,OAAT,EAAiB;AACb,oBAAGiB,KAAKC,GAAL,CAAS,KAAKR,IAAL,CAAUS,CAAV,GAAcH,KAAKG,CAA5B,KAAkC,KAAKT,IAAL,CAAUU,KAAV,GAAgB,CAAhB,GAAoBJ,KAAKK,MAAL,GAAY,CAAlE,IACAJ,KAAKC,GAAL,CAAS,KAAKR,IAAL,CAAUY,CAAV,GAAcN,KAAKM,CAA5B,KAAkC,KAAKZ,IAAL,CAAUU,KAAV,GAAgB,CAAhB,GAAoBJ,KAAKI,KAAL,GAAW,CADpE,EACsE;AAClEG,4BAAQC,GAAR,CAAY,QAAZ;AACA,yBAAKxB,OAAL,GAAe,IAAf;AACAgB,yBAAKb,YAAL,CAAkB,MAAlB,EAA0BsB,IAA1B;AACH;AACJ;AACJ;;AAED,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAId,SAASe,MAA7B,EAAqC,EAAED,CAAvC,EAA0C;AACtC,gBAAIE,cAAchB,SAASc,CAAT,CAAlB;AACA,gBAAGE,YAAYC,IAAZ,IAAoB,QAAvB,EAAgC;AAC5B,oBAAIC,aAAa5C,GAAG6C,EAAH,CAAMH,YAAYN,CAAlB,EAAqBM,YAAYT,CAAjC,CAAjB;AACA,oBAAIa,OAAO,KAAKtB,IAAL,CAAUuB,QAAV,CAAmBC,GAAnB,CAAuBJ,UAAvB,EAAmCK,GAAnC,EAAX;;AAEA,oBAAGH,OAAO,KAAKpB,SAASc,CAAT,EAAYN,KAAZ,GAAkB,CAAjC,EAAmC;AAC/BX,0BAAM2B,WAAN,CAAkBxB,SAASc,CAAT,CAAlB;AACH;AACJ;AACJ;AACJ,KAxDI;AA0DLzB,kBA1DK,4BA0DW;AACZf,WAAGmD,WAAH,CAAe/B,IAAf,CAAoB,KAAKd,UAAzB,EAAqC,KAArC,EAA4C,GAA5C;AACH,KA5DI;AA8DL8C,SA9DK,mBA8DI,CAER,CAhEI;AAkELC,UAlEK,kBAkEGC,EAlEH,EAkEO;AACR,aAAKhC,aAAL;AACA,YAAG,KAAKV,IAAL,GAAY,KAAKD,SAApB,EAA8B;AAC1B,iBAAKa,IAAL,CAAU+B,OAAV;AACH;AACD,aAAK3C,IAAL,IAAa0C,EAAb;AACH;AAxEI,CAAT","file":"Blast.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        blastRadius: 0,\r\n        blastAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.startTime = 0.5;\r\n        this.time = 0;\r\n        this.blastAnimation();\r\n        this.hitBoss = false;\r\n    },\r\n\r\n    blastAnimation(){\r\n        this.playBlastSound();\r\n        var animationComponent = this.getComponent(cc.Animation);\r\n        var animState = animationComponent.play('blast');\r\n        animState.speed = 1 ;\r\n    },\r\n\r\n    detectMonster(){\r\n        var scene = this.node.parent;\r\n        var children = scene.children;\r\n        var playerPos = scene.getChildByName(\"rem\").getPosition();\r\n\r\n        var boss = scene.getChildByName(\"boss\");\r\n        // console.log(boss);\r\n        if(boss != null){\r\n            if(!this.hitBoss){\r\n                if(Math.abs(this.node.y - boss.y) <= this.node.width/2 + boss.height/2 \r\n                && Math.abs(this.node.x - boss.x) <= this.node.width/2 + boss.width/2){\r\n                    console.log(\"击中BOSS\");\r\n                    this.hitBoss = true;\r\n                    boss.getComponent(\"Boss\").life--;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < children.length; ++i) {\r\n            var tempMonster = children[i];\r\n            if(tempMonster.name == \"hulk-1\"){\r\n                var monsterPos = cc.v2(tempMonster.x, tempMonster.y);\r\n                var dist = this.node.position.sub(monsterPos).mag();\r\n\r\n                if(dist < 45 + children[i].width/2){\r\n                    scene.removeChild(children[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    playBlastSound(){\r\n        cc.audioEngine.play(this.blastAudio, false, 0.1);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        this.detectMonster();\r\n        if(this.time > this.startTime){\r\n            this.node.destroy();\r\n        }\r\n        this.time += dt;\r\n    },\r\n});\r\n"]}