{"version":3,"sources":["RedBullet.js"],"names":["Player","require","cc","Class","extends","Component","properties","bulletWidth","speed","onLoad","move","xSpeed","ySpeed","getPlayerPosition","player","getPosition","start","scene","node","parent","sceneWidth","width","sceneHeight","height","getChildByName","x","y","xSpeedSign","ySpeedSign","maxSpeed","Math","abs","detectPlayer","playerPos","dist","position","sub","mag","playerInfo","getComponent","wasDamaged","removeChild","update","dt","destroy","console","log"],"mappings":"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","file":"RedBullet.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nvar Player = require(\"Player\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bulletWidth: 0,\r\n        speed: 0\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        // console.log(\"generated bullet\");\r\n        this.move = false;\r\n        this.xSpeed = 0;\r\n        this.ySpeed = 0;\r\n\r\n\r\n    },\r\n\r\n    // changeSize(){\r\n    //     var scaleUp = cc.scaleTo(1, 2, 2);\r\n    //     var scaleDown = cc.scaleTo(0.5, 1, 1);\r\n\r\n    //     return cc.repeatForever(cc.sequence(scaleUp, scaleDown));\r\n    // },\r\n\r\n    getPlayerPosition() {\r\n        return player.getPosition();\r\n    },\r\n\r\n    start() {\r\n        // this.node.runAction(this.changeSize());\r\n        var scene = this.node.parent;\r\n        this.sceneWidth = scene.width / 2;\r\n        this.sceneHeight = scene.height / 2;\r\n\r\n        var player = scene.getChildByName(\"rem\");\r\n\r\n        this.xSpeed = player.x - this.node.x;\r\n        this.ySpeed = player.y - this.node.y;\r\n\r\n        var xSpeedSign = 1;\r\n        var ySpeedSign = 1;\r\n        if (this.xSpeed < 0) xSpeedSign = -1;\r\n        if (this.ySpeed < 0) ySpeedSign = -1;\r\n\r\n        var maxSpeed = 200;\r\n\r\n        if (Math.abs(this.xSpeed) < Math.abs(this.ySpeed)) {\r\n            this.xSpeed = this.xSpeed * Math.abs(maxSpeed / this.ySpeed);\r\n            // if(Math.abs(this.xSpeed > maxSpeed)) this.xSpeed = xSpeedSign * minSpeed;\r\n            this.ySpeed = ySpeedSign * maxSpeed;\r\n        }\r\n        else {\r\n            this.ySpeed = this.ySpeed * Math.abs(maxSpeed / this.xSpeed);\r\n            // if(Math.abs(this.ySpeed < minSpeed)) this.ySpeed = ySpeedSign * minSpeed;\r\n            this.xSpeed = xSpeedSign * maxSpeed;\r\n        }\r\n        this.move = true;\r\n\r\n    },\r\n\r\n    detectPlayer(){\r\n        var scene = this.node.parent;\r\n        var player = scene.getChildByName(\"rem\");\r\n        var playerPos = player.getPosition();\r\n\r\n        var dist = this.node.position.sub(playerPos).mag();\r\n\r\n        if(dist < this.node.width/2){\r\n            var playerInfo = player.getComponent(Player);\r\n            playerInfo.wasDamaged = true;\r\n            scene.removeChild(this.node);\r\n        }\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        this.detectPlayer();\r\n        if (this.move) {\r\n            this.node.y += this.ySpeed * dt;\r\n            this.node.x += this.xSpeed * dt;\r\n        }\r\n\r\n        if (this.node.x < -this.sceneWidth || this.node.x > this.sceneWidth || this.node.y < -this.sceneHeight || this.node.y > this.sceneHeight){\r\n            this.node.destroy();\r\n            console.log(\"bullet removed\");\r\n        }\r\n    },\r\n});\r\n"]}