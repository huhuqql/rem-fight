{"version":3,"sources":["Boss.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","bulletPrefab","default","type","Prefab","redBulletPrefab","onLoad","jumpAction","setJumpAction","node","runAction","accLeft","accRight","xSpeed","ySpeed","timer","intervalTime","skillTimer","skillIntervalTime","life","move","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","sequence","produceBullet","bullet","instantiate","parent","addChild","setPosition","x","y","moveToRandomPosition","randX","Math","random","getChildByName","width","randY","height","moveToPosition","moveToPlayer","console","log","scene","sceneWidth","sceneHeight","player","oldSpeed","xSpeedSign","ySpeedSign","maxSpeed","abs","setTimeout","stopMoving","bind","produceRedBullet","redbullet","start","update","dt","destroy"],"mappings":"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","file":"Boss.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        jumpHeight: 0,\r\n        jumpDuration: 0,\r\n        maxMoveSpeed: 0,\r\n        accel: 0,\r\n\r\n        bulletPrefab: {\r\n            default: null,\r\n            type: cc.Prefab  \r\n        },\r\n\r\n        redBulletPrefab: {\r\n            default: null,\r\n            type: cc.Prefab  \r\n        },\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n        this.xSpeed = 0;\r\n        this.ySpeed = 0;\r\n\r\n        this.timer = 0;\r\n        this.intervalTime = 6;\r\n\r\n        this.skillTimer = 0;\r\n        this.skillIntervalTime = 3;\r\n        this.life = 60;\r\n    },\r\n\r\n    move() {\r\n\r\n    },\r\n\r\n    setJumpAction: function () {\r\n\r\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n\r\n        return cc.sequence(jumpUp, jumpDown);\r\n    },\r\n\r\n\r\n    produceBullet(){\r\n        var bullet = cc.instantiate(this.bulletPrefab);\r\n        this.node.parent.addChild(bullet);\r\n        bullet.setPosition(this.node.x, this.node.y);\r\n    },\r\n\r\n\r\n    moveToRandomPosition(){\r\n        var randX = (Math.random() - 0.5) * 2 * (this.node.parent.getChildByName(\"newbg\").width / 2 - 50);\r\n        var randY = (Math.random() - 0.5) * 2 * (this.node.parent.getChildByName(\"newbg\").height / 2 - 50);\r\n\r\n        this.moveToPosition(randX, randY);\r\n\r\n    },\r\n\r\n    moveToPlayer(){\r\n        console.log(\"朝玩家移动\");\r\n        var scene = this.node.parent;\r\n        this.sceneWidth = scene.width / 2;\r\n        this.sceneHeight = scene.height / 2;\r\n\r\n        var player = scene.getChildByName(\"rem\");\r\n\r\n        this.xSpeed = player.x - this.node.x;\r\n        this.ySpeed = player.y - this.node.y;\r\n\r\n        var oldSpeed = this.xSpeed;\r\n\r\n        var xSpeedSign = 1;\r\n        var ySpeedSign = 1;\r\n        if (this.xSpeed < 0) xSpeedSign = -1;\r\n        if (this.ySpeed < 0) ySpeedSign = -1;\r\n\r\n        var maxSpeed = 100;\r\n\r\n        if (Math.abs(this.xSpeed) < Math.abs(this.ySpeed)) {\r\n            this.xSpeed = this.xSpeed * Math.abs(maxSpeed / this.ySpeed);\r\n            this.ySpeed = ySpeedSign * maxSpeed;\r\n        }\r\n        else {\r\n            this.ySpeed = this.ySpeed * Math.abs(maxSpeed / this.xSpeed);\r\n            this.xSpeed = xSpeedSign * maxSpeed;\r\n        }\r\n\r\n        setTimeout(function () {\r\n            this.stopMoving();\r\n        }.bind(this), oldSpeed/this.xSpeed * 1000);\r\n\r\n    },\r\n\r\n    stopMoving(){\r\n        this.xSpeed = 0;\r\n        this.ySpeed = 0;\r\n    },\r\n\r\n    produceRedBullet(){\r\n        if(this.node != null){\r\n            var redbullet = cc.instantiate(this.redBulletPrefab);\r\n            this.node.parent.addChild(redbullet);\r\n            redbullet.setPosition(this.node.x, this.node.y);\r\n        }\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    update: function (dt) {\r\n\r\n        if(this.life <= 0){\r\n            this.life = 100;\r\n            this.node.destroy();\r\n        }\r\n\r\n        if (this.timer > this.intervalTime) {\r\n            this.moveToPlayer();\r\n            // this.produceBullet();\r\n            this.timer = 0;\r\n            console.log(\"发射！\");\r\n        }\r\n        if(this.skillTimer >= this.skillIntervalTime && this.xSpeed == 0){\r\n            this.produceRedBullet();\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 300);\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 600);\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 900);\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 1200);\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 1500);\r\n            setTimeout(function () {\r\n                this.produceRedBullet();\r\n            }.bind(this), 1800);\r\n            this.skillTimer = 0;\r\n        }\r\n        this.skillTimer += dt;\r\n        this.timer += dt;\r\n\r\n        if (this.accLeft) {\r\n            this.xSpeed -= this.accel * dt;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        this.node.x += this.xSpeed * dt;\r\n        this.node.y += this.ySpeed * dt;\r\n    },\r\n\r\n});"]}